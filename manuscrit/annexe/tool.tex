
%\begin{savequote}[6cm]
%<< truc
%\qauthor{Test}
%\end{savequote}

\chapter{Scenarios YAML}\label{chap:annexe:tool}
\mtcaddchapter
\chaptertoc

\section{Saturation du lien local}\label{chap:annexe:tool:bp}

\begin{lstlisting}[language=yaml,caption=Scénario de saturation du lien groupe entre le nœud 0 et le nœud 1 avec 8 copies simultanées,label=lst:annexe:tool:bp,multicols=2,xleftmargin=3em]
---
scenarii:
  params: {}
  data:
    n_elems:
      type: int
      value: 25000000
    random:
      type: bool
      value: false
    a0:
      type: double*
      value: 0
    b0:
      type: double*
      value: 0
    a1:
      type: double*
      value: 0
    b1:
      type: double*
      value: 0
    a2:
      type: double*
      value: 0
    b2:
      type: double*
      value: 0
    a3:
      type: double*
      value: 0
    b3:
      type: double*
      value: 0
    a4:
      type: double*
      value: 0
    b4:
      type: double*
      value: 0
    a5:
      type: double*
      value: 0
    b5:
      type: double*
      value: 0
    a6:
      type: double*
      value: 0
    b6:
      type: double*
      value: 0
    a7:
      type: double*
      value: 0
    b7:
      type: double*
      value: 0
  actions:
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a0
    - n_elems
    - random
  - kernel: init_array
    core: 0
    repeat: 1
    sync: false
    flush: false
    params:
    - b0
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a1
    - n_elems
    - random
  - kernel: init_array
    core: 1
    repeat: 1
    sync: false
    flush: false
    params:
    - b1
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a2
    - n_elems
    - random
  - kernel: init_array
    core: 2
    repeat: 1
    sync: false
    flush: false
    params:
    - b2
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a3
    - n_elems
    - random
  - kernel: init_array
    core: 3
    repeat: 1
    sync: false
    flush: false
    params:
    - b3
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a4
    - n_elems
    - random
  - kernel: init_array
    core: 4
    repeat: 1
    sync: false
    flush: false
    params:
    - b4
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a5
    - n_elems
    - random
  - kernel: init_array
    core: 5
    repeat: 1
    sync: false
    flush: false
    params:
    - b5
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a6
    - n_elems
    - random
  - kernel: init_array
    core: 6
    repeat: 1
    sync: false
    flush: false
    params:
    - b6
    - n_elems
    - random
  - kernel: init_array
    core: 8
    repeat: 1
    sync: false
    flush: false
    params:
    - a7
    - n_elems
    - random
  - kernel: init_array
    core: 7
    repeat: 1
    sync: false
    flush: false
    params:
    - b7
    - n_elems
    - random
  - barrier
  - kernel: copy
    core: 0
    repeat: 10
    sync: true
    flush: false
    params:
    - a0
    - b0
    - n_elems
  - kernel: copy
    core: 1
    repeat: 10
    sync: true
    flush: false
    params:
    - a1
    - b1
    - n_elems
  - kernel: copy
    core: 2
    repeat: 10
    sync: true
    flush: false
    params:
    - a2
    - b2
    - n_elems
  - kernel: copy
    core: 3
    repeat: 10
    sync: true
    flush: false
    params:
    - a3
    - b3
    - n_elems
  - kernel: copy
    core: 4
    repeat: 10
    sync: true
    flush: false
    params:
    - a4
    - b4
    - n_elems
  - kernel: copy
    core: 5
    repeat: 10
    sync: true
    flush: false
    params:
    - a5
    - b5
    - n_elems
  - kernel: copy
    core: 6
    repeat: 10
    sync: true
    flush: false
    params:
    - a6
    - b6
    - n_elems
  - kernel: copy
    core: 7
    repeat: 10
    sync: true
    flush: false
    params:
    - a7
    - b7
    - n_elems
  - kernel: void
    core: 8
    repeat: 1
    sync: true
    flush: false
    params: []
  name: bandwidth_200000000_1_8
  watchers:
    time:
    - time
    size:
    - n_elems
\end{lstlisting}

\section{Scénario de base d'un \gemm sur un cœur}\label{chap:annexe:tool:dgemm-base}

\begin{lstlisting}[language=yaml,caption=Scénario de calcul d'un gemm,label=lst:annexe:tool:dgemm-base,multicols=2,xleftmargin=3em]
---
scenarii:
  data:
    bs:
      type: int
      value: 256
    a0:
      type: double*
      value: 0
    b0:
      type: double*
      value: 0
    c0:
      type: double*
      value: 0
  actions:
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - a0
    - bs
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - b0
    - bs
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - c0
    - bs
  - kernel: dgemm
    core: 0
    repeat: '50'
    sync: true
    params:
    - a0
    - b0
    - c0
    - bs
  name: dgemm_256_local_1
  watchers:
    flops_dgemm:
    - bs
    time:
    - time
    papi:
    - PAPI_L3_TCM
    - PAPI_L3_DCR
    - PAPI_L3_DCW
\end{lstlisting}

\section{Sénario d'exécution de 3 \gemm indépendants}\label{chap:annexe:tool:dgemm}

\begin{lstlisting}[language=yaml,caption=Scénario de calcul de 3 gemm indépendants,label=lst:annexe:tool:dgemm,multicols=2,xleftmargin=3em]
---
scenarii:
  data:
    bs:
      type: int
      value: 256
    a0:
      type: double*
      value: 0
    b0:
      type: double*
      value: 0
    c0:
      type: double*
      value: 0
    a1:
      type: double*
      value: 0
    b1:
      type: double*
      value: 0
    c1:
      type: double*
      value: 0
    a2:
      type: double*
      value: 0
    b2:
      type: double*
      value: 0
    c2:
      type: double*
      value: 0
  actions:
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - a0
    - bs
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - b0
    - bs
  - kernel: init_blas_bloc
    core: 0
    repeat: 1
    sync: false
    params:
    - c0
    - bs
  - kernel: init_blas_bloc
    core: 1
    repeat: 1
    sync: false
    params:
    - a1
    - bs
  - kernel: init_blas_bloc
    core: 1
    repeat: 1
    sync: false
    params:
    - b1
    - bs
  - kernel: init_blas_bloc
    core: 1
    repeat: 1
    sync: false
    params:
    - c1
    - bs
  - kernel: init_blas_bloc
    core: 2
    repeat: 1
    sync: false
    params:
    - a2
    - bs
  - kernel: init_blas_bloc
    core: 2
    repeat: 1
    sync: false
    params:
    - b2
    - bs
  - kernel: init_blas_bloc
    core: 2
    repeat: 1
    sync: false
    params:
    - c2
    - bs
  - kernel: dgemm
    core: 0
    repeat: '50'
    sync: true
    params:
    - a0
    - b0
    - c0
    - bs
  - kernel: dgemm
    core: 1
    repeat: '50'
    sync: true
    params:
    - a1
    - b1
    - c1
    - bs
  - kernel: dgemm
    core: 2
    repeat: '50'
    sync: true
    params:
    - a2
    - b2
    - c2
    - bs
  name: dgemm_256_local_3
  watchers:
    flops_dgemm:
    - bs
    time:
    - time
    papi:
    - PAPI_L3_TCM
    - PAPI_L3_DCR
    - PAPI_L3_DCW
\end{lstlisting}
